**Người thực hiện: HOẢ NGỌC LÊ HÙNG**

**AT13M**

Nguồn: [Freetuts](https://freetuts.net)

# Mục lục

[A.Nội dung](#a)


Đang cập nhập...

[B.Tổng Kết](#b)


# Phương thức GET và POST trong PHP.

## Phương thức GET trong PHP.

Phương thức GET rất dễ nhận thấy trên URL sẽ kèm theo dữ liệu mà chúng ta muốn gửi.

Cú pháp: `$id = $_GET['id'];`

Lưu ý trước khi lấy một dữ liệu nào đó bạn phải kiểm tra tồn tại không mới lấy nhé. Nếu không sẽ báo lỗi ngay. Để kiểm tra ta dùng hàm `isset($tenbien)`

## Phương thức POST trong PHP

Phương thức POST có tính bảo mật hơn vì dữ liệu gửi phải thông qua một form HTML nên nó bị ẩn, chúng ta không thấy các giá trị đó được.

Cú pháp: 

```
if (isset($_POST['id'])){
    $id = $_POST['id'];
}

```

## So sánh giữa POST và GET.

**Giống nhau:**

Đều gửi dữ liệu lên Server.

**Khác nhau**

Phương thức POST bảo mật hơn GET vì dữ liệu được gửi ngầm bằng mắt thường không thể nhìn thấy được.

Phương thức GET dữ liệu được gửi tường minh, chúng ta có thể thấy trên URL nên nó không bảo mật.

Phương thức GET luôn luôn nhanh hơn POST vì dữ liệu gửi đi được Browser giữ lại trong cache. Khi thực thi với POST thì Server luôn thực thi lệnh rồi trả về cho Client, còn với GET thì Browser sẽ kiểm tra trong cache có chưa, nếu có thì trả về ngay chứ không cần gửi lên Server.

# Các hàm xử lý chuỗi trong PHP


`addcslashes($str,$char_list)`: hàm này sẽ thêm dấu gạch chéo đằng trước những ký tự trong chuỗi $str mà ta liệt kê ở $char_list.

`addslashes($str)`: hàm này sẽ thêm dấu gạch chéo đằng trước những ký tự (;,",\) trong chuỗi $str.

`stripslashes($str)`: xoá các ký tự \ trong chuỗi $str.

`crc32($str)`:hàm này sẽ chuyển chuỗi $str thành một dãy sỗ nguyên.

`explode($delimiter,$string)`: hàm này chuyển một chuỗi $string thành một mảng các phần tử với ký tự tách mảng là $delimiter.

`implode($delimiter,$piecesarray)`: Chuyển một mảng $piecesarray thành chuỗi và mỗi phần tử cách nhau bởi một chuỗi $delimiter.

`ord($string)`: hàm trả về mã ASCII của ký tự đầu tiên trong chuỗ $string.

`strlen($string)`: hàm này đếm số ký tự của chuỗi $string.

`str_word_count($str)`: Hàm này đếm số tử trong chuỗi.

`str_repeat($str, int $n)`: Hàm này lặp lại chuỗi $str $n lần.

`str_replace($chuoi_tim,$chuoi_thay_the,$chuoi_nguon)`: hàm tìm kiếm và thay thế chuỗi.

`md5($str)`: hàm này mã hoá chuỗi thành một dã 32 ký tự.

`strip_tags($string,$allow_tags)`: hàm này bỏ các thẻ HTML trong chuỗi $string được khai báo ở $allow_tags. 


# Các hàm xử lý file trong PHP.

## Mở file.

Cú pháp: `open($path,$option)`: $path là đường dẫn đến file cần mở, $option là quyền cho phép thao tác trên file.

<img src="http://sv1.upsieutoc.com/2017/05/08/read.png">

## Đọc file.

Ta dùng hàm `fget($fp)` để đọc theo từng ký tự, dùng fget($fp) để đọc theo từng dòng. Đối với đọc từng dòng và từng ký tự ta phải dùng hàm `feof($fp)` đặt trong vòng lặp while để sau khi đọc xong nó đọc sang dòng mới hoặc kí tự mới.

## Ghi file.

Để ghi nội dung vào file ta dùng hàm `fwrite($fp,$content)` trong đó $fp là đối tượng trả về lúc mở file, còn $content là nội dunng muối ghi vào.

## Đóng file.
Việc mở file để sử dụng mà không đóng file rất nguy hiểm, vì thế sau khi sử dụng xong bạn nên đóng file để an toàn hơn. Để đóng file ta dùng hàm `fclose($fp)` trong đó $fp là đối tượng trả về lúc bạn mở file.

## Kiểm tra file có tồn tại không.

Ta dùng hàm `file_exists($path)`, trong đó $path là đường dẫn đến file cần kiểm tra.

## Kiểm tra file có được cấp quyền ghi hay không.

Ta dùng hàm `is_writiable($path)` trong đó $path là đường dẫn đến file cầm kiểm tra.

## Đổi tên file.

Để đổi tên file ta dùng hàm `rename($oldname,$newname)`, trong đó $oldname đường dãn đến file cần đổi tên, $newname là đường dẫn đến tên file cần đổi.

## Copy file.

Để copy file mới ta nên dùng hàm `copy($source,$dest)`, trong đó $source là đường dẫn file cần copy và $dest là đường dẫn file di chuyển tới. Nếu bạn muốn đổi tên đường dẫn $dest bạn khai báo một tên khác.

## Xoá file.

Ta dùng hàm `unlink($path)` để xoá file, trong đó $path là đường dẫn đến file cần xoá.

## Kiểm tra một đường dẫn folder có tồn tại không.

Ta dùng hàm `is_dir($filename)`, trong đó $filename là đường dẫn đến folfer cần kiểm tra.

## Tạo một folder mới.

Ta dùng hàm `mkdir($path)` để tạo một folder mới, trong đó $path là đường dẫn đến folder cần tạo.

Để đọc file ta dùng hàm `fread($fp,$size)`: trong đó $fp là đối tượng lúc mở file còn $size là kích cỡ file cần đọc. Để lấy kích cỡ file ta dùng hàm `fliesize($path)`.

Ví dụ: Đọc file qua từng ký tự

# Sesion và cookie trong php.

Sesion và cookie trong php dùng để lưu trữ dữ liệu tạm thời. Cả hai có chức năng là lưu trữ dữ liệu nhưng bên trong đó lại khác nhau. Sesion dùng để lưu trữ dữ liệu trên Server và đồng thời sẽ có một đoạn code dữ liệu lưu trữ ở Client (Coolie). Còn Cookie thì lưu trữ dữ liệu trên máy Client.

## Sesion in PHP.

Đăng ký sesion : `sesion_start()`

Lưu trữ sesion có cú pháp như sau: 

`$SESION['Tên_sesion'] = $Biến_session`

Ví dụ: 

```
<?php 
session_start();

if(isset($_POST['save_sesion']))
{
// Lưu sesion
$_SESSION['name']=$_POST['username'];
}
?>
```

Xoá session.

Cú pháp: `unset($_SESSION['session_name']);`

Để xoá hết tất cả session `session_destry();`


## Cookie in PHP.

Coolie thường được dùng để lưu trữ các tuỳ chọn riêng của trang web từng user, nó là một file nhỏ được Server chỉ định lưu trữ trên máy tính của Client và PHP có thể xuất tới được. Và để có thể sử dụng được Cookie thì trình duyệt phải hỗ trỡ chức năng này, nếu không Cookie trở nên vô dụng.

Cookie sẽ không mất khi bạn đóng ứng dụng, nó phụ thuộc vào thời gian sống mà bạn thiết lập cho nó. Ví dụ bạn thiết lập Cookie lưu trữ thông tin đăng nhập trong 15 phút thì sau 15 phút mà bạn không thao tác thay đổi trên nó thì Cookie của bạn sẽ chết. Đây chính là sự lợi hại của việc sử dụng Cookie.

**Lưu trữ Cookie:**

`setcookie($name,$value,$expire,$path,$domain)`

Trong đó:
<ul>
	<li>$name: là tên Cookie.</li>
	<li>$value: là giá trị Cookie.</li>
	<li>$expire: thời gian sống của Cookie.</li>
	<li>$path: đường dẫn lưu trữ Cookie.</li>
	<li>$domian: Tên của domain.</li>
</ul>

**Lấy giá trị Cookie**

`$bien = $_COOKIE['cookie_name']`

Lưu ý trước khi lấy giá trị phỉa kiểm tra xem cookie có tồn tại không.

```
if (isset($_COOKIE['username']))
{
echo $_COOKIE['username'];
}
```

**Xoá cookie**

Để xoá Cookie chỉ cần thiết lập thời gian sống của nó sang giá trị ân nhiều hơn hoặc bằng giá trị sống lúc bạn thiết lập.

`setcookie("username","",time()-3600);`

# Hàm isset() và empty() trong PHP.

## Hàm iset().

Dùng để kiểm tra một biến nào đó tồn tạo trong bộ nhớ hay chưa.

## Hàm empty() trong PHP.

Dùng để kiểm tra một biến nào đó có giá trj rỗng hoặc chưa được khởi tạo hay không.

# Lệnh require - require_once - include - include_once trong PHP

## Lệnh require-require_once-include-include_once.

Lệnh require: dùng để import một file PHP khác vào file hiện tại, lúc này file hiện tại mới có thể sử dụng mọi tại nguyên của file import đó.

Lệnh require_once: Lệnh này chẳng khác gì lệnh require, tuy nhiên điểm khác biệt đó là lệnh require_once chỉ có import một lần, nghĩa là khi bạn sử dụng hai lệnh require_once cùng một file thì ở lệnh require_once thứ hai thấy đã xử lý rồi nên không thực thi nữa.

Lệnh include: Công dụng và tính chất giống như lệnh require.

Lệnh include_once: Công dụng và tính chất giống với lệnh require_once.

## Sự giống và khác nhau giữa require và include.

Giống: Cả hai đểu có nhiệm vụ import một file PHP khác.

Khác nhau: Nếu import một file bằng lệnh require thì nếu chương trình bị lỗi thì laaoj tức chương trình biện dịch sẽ dừng xuất và thông báo lỗi.
Còn nếu sử dụng lệnh include thì đó chỉ là một cảnh báo nên chương trình vẫn chạy cho đến cuối chương trình.










# Kết nối cơ sở dữ liệu MySQL

## Kết nối database

Cú pháp: 

`mysqli_connect($host,$user,$password,$database,$port,$socket)`

Ví dụ: ` mysqli_connect('localhost','root','','data')  or die("Không thể kết nối database")`

## Truy vấn lấy danh sách record

```
Kết nối database
$conn = mysqli_connect('localhost','root','','data') or die("Không thể kết nối database");

Câu truy vấn vào bảng trong database
$sql = "SELECT * FROM users";

Thực hiện truy vấn, hàm này truyền hai tham số vào là biến kết nối và câu truy  vấn.
$result = mysqli_query($conn,$sql);

Kiểm tra xem câu truy vấn có thực thi không.
if(!$result){
	die("Câu truy vấn bị sai.");
}

Lấy ra số hàng trong databasse
$num = mysqli_num_rows($sql);

Ngắt kết nối với database.
mysqli_close($conn);
```

## Câu truy vấn.

`$sql = "DELETE FROM users WHERE id = 1";`

Ý nghĩa câu truy vấn: Xoá tù bảng users có cột id = 1.

## Câu truy vấn update.

`$sql = "UPDATE users SET name = 'hungle' WHERE ID = 2"`

Ý nghĩa câu truy vấn: Cập nhập vào bảng users lưu với tên hungle với id = 2.


# Chức năng đăng ký thành viên.

## Tạo form đăng ký.

```
<div id="dangki" style="text-align: left;">
  <form method="POST" action="">
    <input type="text" name="ho" placeholder="Họ" style="width: 100px">  <input type="text" name="ten" placeholder="Tên" style="width: 100px"><br>
    <input type="email" name="email" placeholder="Địa chỉ email." style="width: 100px">  <input type="number" name="sdt" maxlength="11" placeholder="Phone number" style="width: 100px"><br>
    <input type="text" name="username" placeholder="Username" style="width: 100px"> <input type="password" name="password" maxlength="20" placeholder="Password" style="width: 100px">
    <br>
    Gender:
    <br>
    <input name="Gender" list="html" />
    <datalist id="html">
      <option value="Nam"></option>
      <option value="Nữ"></option>
    </datalist>
    <br> 
    Ngày sinh:
    <br>
    <input type="number" name="date" placeholder="Ngày" style="width: 60px" min="1" max="31">  <input type="number" min="1" max="12" name="mounth" placeholder="Tháng" style="width: 70px"> <input type="number" name="year" placeholder="Năm" style="width: 70px" min="1900" max="1999">
<br>
    <input type="submit" name="submit" value="Đăng ký">  <input type="reset" value="Đặt lại">
  </form>
</div>
```

Kết quả ta được form đăng ký như sau:

<img src="http://sv1.upsieutoc.com/2017/05/08/dangky.png">

## Thực hiện chữ năng đăng ký.

```
<?php
    require_once("lib/connection.php");// Lấy các kết nối CSDL từ file connection.php
    if (isset($_POST["submit"])) // Nếu người dùng nhấn nút submit thì thực hiện các câu lệnh bên dưới
{
        //lấy thông tin từ các form bằng phương thức POST
        //Gán các biến bằng các giá trị lấy từ các field đăng ký để xử lý thông tin.
      $ho = $_POST['ho'];
    $ten = $_POST['ten'];
    $email = $_POST['email'];
    $sdt = $_POST['sdt'];
    $username = $_POST['username'];
    $password = $_POST['password'];
    $Gender = $_POST['Gender'];
    $ngay = $_POST['date'];
    $thang = $_POST['mounth'];
    $nam = $_POST['year'];
        //Kiểm tra điều kiện bắt buộc đối với các field không được bỏ trống
        
    if($username=="" || $password=="" || $ho =="" || $ten=="" || $email == "" || $sdt == "" || $Gender == "" || $ngay == "" || $thang == "" || $nam =="")

     {
           echo "bạn vui lòng nhập đầy đủ thông tin";
        }else{
            // Kiểm tra tài khoản đã tồn tại chưa
            $sql="select * from users where username='$username'";// Câu lệnh truy vấn vào bảng users với cột username.
          $kt=mysqli_query($conn, $sql);// Câu lệnh truy vấn
 
          if(mysqli_num_rows($kt)  > 0)//Kiểm tra xem username đã tồn tại chưa.
          {
            echo "Tài khoản đã tồn tại";
          }
          else{
            //thực hiện việc lưu trữ dữ liệu vào db
              $sql = "INSERT INTO users (ho,ten,email,sdt,username,password,gender,ngaysinh,thangsinh,namsinh) VALUE('$ho','$ten','$email','$sdt','$username','$password','$Gender','$ngay','$thang','$nam')";// Lưu thông tin vào bảng users với các giá trị trong bảng từ các biến gán ban đầu.
              
              mysqli_query($conn,$sql);// Thực thi câu lệnh truy vấn để lưu thông tin.
              echo 'Chúc mừng bạn đã đăng kí thành công.'.''.'<a href="website.php">Trang Chủ</a>';// Xuất ra màn hình đã đăng ký thành công. Quay về trang chủ để đăng nhập.
          }
                      
          
        }
  }
  ?>
```

# Chức năng đăng nhập.

## Tạo form đăng nhập.

```
 <div id="sign">

  <form action="website.php" method="POST" name="dangnhap">
      Username :<input type="text" name="Username" placeholder="Username" /><br/>
      Password :<input type="Password" name="Password" placeholder="Password" /><br/>
       <input type="checkbox" name="vehicle1" value="Ghi nhớ đăng nhập">Ghi nhớ đăng nhập<br>
      <input type="submit" name="submit" value="Đăng nhập">
  </form>

  <form method="POST" action="dangky.php">
    <input type="submit" name="dangki" value="Đăng ký">
  </form>

</div>
```

Kết quả:

<img src="http://sv1.upsieutoc.com/2017/05/08/dangnhapcde69.png">

## Thực hiện chức năng đăng nhập.

```
//gọi file connection.
require_once("lib/connection.php");
if(isset($_POST["submit"]))
{
  // lấy thông tin người dùng.
  $Username = $_POST["Username"];
  $Password = $_POST["Password"];
  //làm sạch có thẻ html, ký tự đặc biệt.
  //mà người dùng cố tình thêm vào để tấn công theo phương thức sql injection.
  $Username = strip_tags($Username);
  $Username = addslashes($Username);
  $Password = strip_tags($Password);
  $Password = addslashes($Password);

  if ($Username == "" || $Password == "") // Kiểm tra xem username và password có trống không.
  {
    echo "Tên đăng nhập hoặc mật khẩu không được để trống";
  }
  else
  {
    $sql = "select * from users where username = '$Username' and Password = '$Password' ";
    $query = mysqli_query($conn,$sql); // câu lệnh truy vấn.
    $num_rows = mysqli_num_rows($query);//lấy ra số hàng trong databasse.
    if($num_rows==0)
    {
      echo "Tên đăng nhập hoặc mật khẩu không đúng.";
    }
    else
    {
      //tiến hành lưu tiên đăng nhập vào session để tiện xử lý sau này.
      $_SESSION['username']=$Username;

      header('website.php');
    }
  }
}
?>
```

# Chức năng tìm kiếm trong PHP.

## Tạo form tìm kiếm.

```
<div id="search">
  <div>
  <form action="ketqua.php" method="POST">
    <input type="text" name="search" placeholder="Enter your keyword...">
    <input type="submit" name="ok" value="Search">
  </form>
</div>
```

Kết quả như sau: 

<img src="http://sv1.upsieutoc.com/2017/05/08/search.png">

## Thực hiện chức năng tìm kiếm.

```
<?php 
  $conn = mysqli_connect("localhost","root","",'data') or die("Không thể kết nối.");//kết nối


  //$output = "";
  if(isset($_POST['ok']))
  {
    $search = addslashes($_POST['search']);// chống sql injection

    if($search == "")
    {
      echo "Nhập từ khoá";
      //$output = "Nhập từ khoá";
    }
    else
    {
      $query = "select * from users where username like '%$search%' ";//tim kiếm dữ liệu
      $sql = mysqli_query($conn,$query);//thực hiện câu lệnh truy vấn.
      $num = mysqli_num_rows($sql);//đếm ra số đong trong mảng.

      if($num == 0)
      {
        echo "Không có kết quả";
        //$output = "Không có kết quả.";
      }
      else
      {
        echo ("Có $num kết quả tìm thấy.<br>");
        while ($row = mysqli_fetch_assoc($sql)) {
          echo 'Tên: '.$row['username'];
          echo '<br>';
          echo 'Địa chỉ email: '.$row['email'];
        }
      }


    }
  }
?>
```

Kết quả:

<img src="http://sv1.upsieutoc.com/2017/05/08/oksearch.png

# Chức năng bình luận trong PHP.

## Tạo form ình luận.

```
<div>
  <form method="POST" action="">
    Tên của bạn:  <input type="text" name="name" placeholder="Ví dụ: Hùng Lê"><br>
    <textarea name="comment" placeholder="What do you think about it!" style="width: 300px ;height: 150px "></textarea>
    <input type="submit" name="cmt" value="Comment">
  </form>
</div>
```

## Thực hiện chức năng bình luận.

```
if($_POST)
{
  if (isset($_POST['name']) || isset($_POST['comment'])) {
    $file_name="comment.txt";
    //khai báo để lưu cmt.
    $name = $_POST['name'];
    $comment = $_POST['comment'];

    $fwrite = fopen($file_name, 'a+');//mở file để viết cmt vào.
    $filewrite = fwrite($fwrite,"<b>".$name."</b>:<br>".$comment."<br>");
    fclose($fwrite); // đóng file lại.

    $fread = fopen($file_name, 'r');
    //mở file để đọc nội dung.
    while (!feof($fread)) {
      echo fread($fread, 1024);
    }
    fclose($fread); //đóng file lại
  }
  else
  {
    echo "Vui lòng điền nội dung.";
  }
}
?>
```
**Kết quả**

<img src="http://sv1.upsieutoc.com/2017/05/08/cmt.png">


# Upload file in PHP.

## Tạo form upload.

```
<form action="form.php" method="post" enctype="multipart/form-data">
	Select file : <input type="file" name="file" size="20" /><br />
    <input type="submit" value="Upload" name="ok" />
</form>
```

Để có thể upload được file chúng ta cần có input với type=`"file"` và trên form upload chúng ta cần định thuộc tính `enctype="multipart/form-data" `. Nó chỉ định loại nội dung nào cần sử dụng khi gửi biểu mẫu

## Thực hiện chức năng upload.

```
<?php
  if(isset($_POST['ok'])){ // Người dùng đã ấn submit
      if($_FILES['file']['name'] != NULL){ // Đã chọn file
           // Tiến hành code upload file
		   if($_FILES['file']['type'] == "image/jpeg"|| $_FILES['file']['type'] == "image/png"|| $_FILES['file']['type'] == "image/gif")
		   {
			  // là file ảnh
			  // Tiến hành code upload
			  if($_FILES['file']['size'] > 1048576){
			      echo "File không được lớn hơn 1mb";
			  }else{
			      // file hợp lệ, tiến hành upload
			      $path = "data/"; // ảnh upload sẽ được lưu vào thư mục data
			      $tmp_name = $_FILES['file']['tmp_name'];
			      $name = $_FILES['file']['name'];//ten 
			      $type = $_FILES['file']['type']; //loại file
			      $size = $_FILES['file']['size']; //kích cỡ file.
			      // Upload file
			      move_uploaded_file($tmp_name,$path.$name);
			      echo "File uploaded! <br />";
			      echo "Tên file : ".$name."<br />";
			      echo "Kiểu file : ".$type."<br />";
			      echo "File size : ".$size;
			  }
			}else{
			  // không phải file ảnh
			  echo "Kiểu file không hợp lệ";
			}
	  }else{
           echo "Vui lòng chọn file";
      }
  }
?>
```

# Download in PHP.

Tạo một link download như sau:

`<a href="download.php">Download</a>`

Tạo một file với tên `download.php` và lưu thông tin như sau.

```
<?php
$file_name = "hinh.jpg";
if(file_exists($file_name))
{
	header('Cache-control: private');
	// Báo cho trình duyệt biết cơ chế điểu khiển cache là `private`, chỉ cho phép client cache nội dung của file không cho phép proxies caching nội dung file, cache là bộ nhớ đệm do trình duyệt tao ra để hỗ trợ quá trình xử lí, và nó lưu 1 sô thông tin cần thiết.
	
	header('Content-Type: application/octet-stream');
	// Thông báo cho trình duyệt dữ liệu trả về ở dạng nhị phân.
	
	header('Content-Length: '.filesize($file_name));
	// Thông báo dung lượng của file muốn downlaod
	
	header('Content-Disposition: attachment; filename='.$file_name);
	// Thông báo cho trình duyệt biết tên file và lựa chọn `attachment` là file phải được download.
	readfile($file_name);
	exit;
}
?>
```
